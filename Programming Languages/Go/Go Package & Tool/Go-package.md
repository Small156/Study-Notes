# Go 包

目录：

- [Go 包](#go-包)
  - [包简介](#包简介)
    - [包名惯例](#包名惯例)
    - [main 包](#main-包)
  - [包导入](#包导入)
    - [远程导入](#远程导入)
    - [命名导入](#命名导入)
  - [init 函数](#init-函数)
  - [参考资料](#参考资料)

## 包简介

Go 语言的程序都会组织成若干组文件，每组文件被称为一个包。每个包的代码都可以作为很小的复用单元，被其他项目单独导入和使用。

* 所有 `.go` 文件，除了空行和注释，都应该在第一行声明自己所属的包；
* 同一个目录下的所有 `.go` 文件都必须声明同一个包名。即不能把多个包放到同一个目录中，也不能把同一个包的文件分拆到多个不同目录中。

### 包名惯例

* 包命名的惯例是使用包所在目录的名字；
* 给包及其目录命名时，应该使用简洁、清晰且全小写的名字；
* 尽可能让命名有描述性且无歧义；
* 包名一般采用单数的形式。

### main 包

Go 中，命名为 `main` 的包具有特殊的含义，Go 语言编译程序会试图把这种包编译为二进制可执行程序，**所有用 Go 编译的可执行程序都必须有一个名叫 main 的包。** 同时当编译器发现某个包的名字为 `main` 时，**也一定需要发现名为 `main()` 的函数，** 否则不会创建可执行文件。

当试图编译并运行在非 `main` 包的 `.go` 文件时，会报错：`go run: cannot run non-main package`。

## 包导入

Go 通过 `import` 语句导入包。

```go
import (
    "fmt"
    "strings"
)
```

* Go 会首先查找 Go 的安装目录（包含标准库中的包）；
* 然后再顺序查找 `GOPATH` 变量中列出的目录（包含开发者创建的包）。

一旦编译器找到一个满足 `import` 语句的包，就会停止进一步查找。

### 远程导入

如果导入路径中包含 `URL`，Go 工具链将从 `DVCS` 获取包，并把包的源代码保存到 `GOPATH` 指向的路径里与 `URL` 匹配的目录中。

```go
import "github.com/spf13/viper"
```

该过程由 `go get` 命令完成。`go get` 将获取任意指定的 `URL` 的包，或一个已经导入的包所依赖的其他包。即该命令会递归地获取到所有依赖包。

### 命名导入

如果要导入的包具有相同的名字，则可以通过 `命名导入` 来避免冲突。`命名导入` 指：在 `import` 语句给出的包路径左侧定义一个名字，将导入的包命名为新名字。

```go
import (
    "fmt"
    myfmt "mylib/fmt"
)

func main() {
    fmt.Println("Standard Library")
    myfmt.Println("mylib/fmt")
}
```

有时导入一个包，但不需要这个包的标识符，这种情况下，可以使用 `_` 空白标识符来重命名这个包,以避免编译器因为包未使用而报错。

## init 函数

每个包可以包含任意多个 `init` 函数，这些函数都会在程序执行开始的时候被调用（即 `main` 函数之前）。

`init` 函数用于设置包、初始化变量或者其他要在程序运行前优先完成的引导工作。

```go
func init() {
	fmt.Println("First print")
}
```

## 参考资料

* 《Go 语言实战》
* 《Go 语言圣经》
